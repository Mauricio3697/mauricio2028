<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora de Investimentos Avan√ßada</title>
  <!-- Chart.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6">
  <div class="bg-white shadow-md rounded-lg p-4 max-w-sm mx-auto text-center">
    <h2 class="text-xl font-semibold text-gray-800 mb-3">Navega√ß√£o</h2>
    <nav class="space-y-2">
      <a href="livros.html" class="block text-gray-700 hover:text-blue-600 transition">üìö Plano de Leitura</a>
      <a href="calculado.html" class="block text-gray-700 hover:text-green-600 transition">üìä Calculadora</a>
      <a href="carreira.html" class="block text-gray-700 hover:text-purple-600 transition">üöÄ Planejamento</a>
      <a href="index.html" class="block text-gray-700 hover:text-purple-600 transition"> 3 Portf√≥lio</a>
    </nav>
  </div>
  <div class="max-w-6xl mx-auto">
    <h1 class="text-4xl font-bold text-blue-800 mb-8">Calculadora de Investimentos Avan√ßada</h1>
    
    <!-- Se√ß√£o: M√©todo Bazin -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-bold text-blue-600 mb-4">M√©todo Bazin</h2>
      <form id="bazinForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold mb-1">Dividendos (R$):</label>
          <input type="number" id="bazinDividend" class="w-full border rounded p-2" placeholder="Ex.: 120" />
        </div>
        <div>
          <label class="block font-semibold mb-1">Taxa de Crescimento (% ao ano):</label>
          <input type="number" id="bazinGrowth" class="w-full border rounded p-2" placeholder="Ex.: 5" />
        </div>
        <div>
          <label class="block font-semibold mb-1">Taxa de Desconto (%):</label>
          <input type="number" id="bazinDiscount" class="w-full border rounded p-2" placeholder="Ex.: 10" />
        </div>
        <div class="md:col-span-2">
          <button type="button" onclick="calculateBazin()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded">Calcular Valor Intr√≠nseco (Bazin)</button>
        </div>
      </form>
      <div id="bazinResult" class="mt-4 text-xl font-bold text-blue-800"></div>
    </div>
    
    <!-- Se√ß√£o: M√©todo Graham -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-bold text-blue-600 mb-4">M√©todo Graham</h2>
      <form id="grahamForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold mb-1">Lucro por A√ß√£o (EPS):</label>
          <input type="number" id="grahamEPS" class="w-full border rounded p-2" placeholder="Ex.: 3.5" />
        </div>
        <div>
          <label class="block font-semibold mb-1">Valor Patrimonial por A√ß√£o (Book Value):</label>
          <input type="number" id="grahamBV" class="w-full border rounded p-2" placeholder="Ex.: 20" />
        </div>
        <div class="md:col-span-2">
          <button type="button" onclick="calculateGraham()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded">Calcular Valor Intr√≠nseco (Graham)</button>
        </div>
      </form>
      <div id="grahamResult" class="mt-4 text-xl font-bold text-blue-800"></div>
    </div>
    
    <!-- Se√ß√£o: Calculadora Avan√ßada ‚Äì Viver de Renda -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-bold text-blue-600 mb-4">Calculadora Avan√ßada: Viver de Renda</h2>
      <form id="livingForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold mb-1">Renda Mensal Desejada (R$):</label>
          <input type="number" id="desiredIncome" class="w-full border rounded p-2" placeholder="Ex.: 5000" />
        </div>
        <div>
          <label class="block font-semibold mb-1">Taxa de Retorno Anual Esperada (%):</label>
          <input type="number" id="expectedReturn" class="w-full border rounded p-2" placeholder="Ex.: 7" />
        </div>
        <div>
          <label class="block font-semibold mb-1">N√∫mero de Anos para Atingir (10 a 20 anos):</label>
          <input type="number" id="yearsToRetire" class="w-full border rounded p-2" placeholder="Ex.: 15" />
        </div>
        <div>
          <label class="block font-semibold mb-1">Capital Inicial (R$):</label>
          <input type="number" id="initialCapital" class="w-full border rounded p-2" placeholder="Ex.: 0" />
        </div>
        <div class="md:col-span-2">
          <button type="button" onclick="calculateLivingOffIncome()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded">Calcular Necessidade de Investimento</button>
        </div>
      </form>
      <div id="livingResult" class="mt-4 text-xl font-bold text-blue-800"></div>
      <canvas id="livingChart" class="mt-6"></canvas>
    </div>
    
    <!-- Se√ß√£o: A√ß√µes S√≥lidas e Fundos Imobili√°rios -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h2 class="text-2xl font-bold text-blue-600 mb-4">A√ß√µes S√≥lidas Perenes e Fundos Imobili√°rios</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-gray-50 p-4 rounded-lg">
          <h3 class="font-bold mb-2">A√ß√µes S√≥lidas Perenes:</h3>
          <ul class="list-disc list-inside space-y-2">
            <li>ITUB4: Estabilidade e hist√≥rico consistente</li>
            <li>PETR4: Forte presen√ßa no setor energ√©tico</li>
            <li>VALE3: Lideran√ßa em minera√ß√£o</li>
            <li>ITSA4: Solidez financeira e bons dividendos</li>
          </ul>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg">
          <h3 class="font-bold mb-2">Fundos Imobili√°rios:</h3>
          <ul class="list-disc list-inside space-y-2">
            <li>HGLG11: Portf√≥lio diversificado e gest√£o ativa</li>
            <li>KNRI11: Excelente hist√≥rico de rendimentos</li>
            <li>MXRF11: Foco em renda e valoriza√ß√£o de ativos</li>
            <li>VISC11: Investimentos em log√≠stica e varejo</li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>
  
  <script>
    // Calculadora Bazin
    function calculateBazin() {
      const dividend = parseFloat(document.getElementById('bazinDividend').value) || 0;
      const growth = parseFloat(document.getElementById('bazinGrowth').value) || 0;
      const discount = parseFloat(document.getElementById('bazinDiscount').value) || 0;
      const discountRate = discount / 100;
      const growthRate = growth / 100;
      if (discountRate <= growthRate) {
        document.getElementById('bazinResult').innerText = "Erro: A taxa de desconto deve ser maior que a taxa de crescimento.";
        return;
      }
      const intrinsicValue = dividend / (discountRate - growthRate);
      document.getElementById('bazinResult').innerText = `Valor Intr√≠nseco Estimado: R$ ${intrinsicValue.toFixed(2)}`;
    }
    
    // Calculadora Graham
    function calculateGraham() {
      const eps = parseFloat(document.getElementById('grahamEPS').value) || 0;
      const bv = parseFloat(document.getElementById('grahamBV').value) || 0;
      // F√≥rmula de Graham: ‚àö(22.5 * EPS * Book Value)
      const intrinsicValue = Math.sqrt(22.5 * eps * bv);
      document.getElementById('grahamResult').innerText = `Valor Intr√≠nseco (Graham): R$ ${intrinsicValue.toFixed(2)}`;
    }
    
    // Calculadora Avan√ßada ‚Äì Viver de Renda
    let livingChart; // Vari√°vel global para o gr√°fico
    function calculateLivingOffIncome() {
      const desiredIncome = parseFloat(document.getElementById('desiredIncome').value) || 0;
      const expectedReturn = parseFloat(document.getElementById('expectedReturn').value) || 0;
      const yearsToRetire = parseFloat(document.getElementById('yearsToRetire').value) || 0;
      const initialCapital = parseFloat(document.getElementById('initialCapital').value) || 0;
      
      const annualReturn = expectedReturn / 100;
      const monthlyRate = annualReturn / 12;
      const totalMonths = yearsToRetire * 12;
      
      // Patrim√¥nio necess√°rio para gerar a renda desejada:
      // Renda anual desejada = renda mensal * 12
      // Patrim√¥nio necess√°rio = (renda anual desejada) / (annualReturn)
      const requiredPortfolio = (desiredIncome * 12) / annualReturn;
      
      // Calcula o aporte mensal necess√°rio para atingir o patrim√¥nio requerido em "totalMonths" meses.
      // F√≥rmula do valor futuro: FV = initialCapital*(1+monthlyRate)^totalMonths + contribution * ((1+monthlyRate)^totalMonths - 1)/monthlyRate
      // Queremos que FV = requiredPortfolio e resolvemos para "contribution":
      let monthlyContribution = 0;
      const factor = Math.pow(1 + monthlyRate, totalMonths);
      if (monthlyRate !== 0) {
        monthlyContribution = (requiredPortfolio - initialCapital * factor) * monthlyRate / (factor - 1);
      } else {
        monthlyContribution = (requiredPortfolio - initialCapital) / totalMonths;
      }
      
      // Exibe os resultados
      document.getElementById('livingResult').innerText = `Patrim√¥nio Necess√°rio: R$ ${requiredPortfolio.toFixed(2)} | Aporte Mensal Necess√°rio: R$ ${monthlyContribution.toFixed(2)}`;
      
      // Dados para o gr√°fico: evolu√ß√£o do patrim√¥nio a cada ano
      const labels = [];
      const dataPoints = [];
      let capital = initialCapital;
      for (let m = 0; m <= totalMonths; m++) {
        if (m > 0) {
          capital = capital * (1 + monthlyRate) + monthlyContribution;
        }
        if (m % 12 === 0) {
          labels.push(`Ano ${m / 12}`);
          dataPoints.push(capital);
        }
      }
      
      const ctx = document.getElementById('livingChart').getContext('2d');
      if (livingChart) {
        livingChart.destroy();
      }
      livingChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Evolu√ß√£o do Patrim√¥nio (R$)',
            data: dataPoints,
            borderColor: '#ED64A6',
            backgroundColor: 'rgba(237, 100, 166, 0.2)',
            fill: true
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: value => `R$ ${value}`
              }
            }
          }
        }
      });
    }
  </script>
</body>
</html>
